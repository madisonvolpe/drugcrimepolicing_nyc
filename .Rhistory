joined %>%
mutate(MP = ifelse(grepl("marijuana", pd_desc,ignore.case = T) & grepl("possession", pd_desc, ignore.case = T), 1,0))
head(joined$law_cat_cd)
joined$law_cat_cd <- as.character(joined$law_cat_cd)
joined %>%
mutate(MP_Mis = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("possession", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0))
joined %>%
mutate(MP_Mis = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("possession", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
MP_Fel = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("possession", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0))
unique(joined$pd_desc)
joined %>%
mutate(MP_Mis = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("possession", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
MP_Fel = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("possession", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
MS_Mis = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
MS_Fel = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0)
)
unique(joined$pd_desc)
joined %>%
mutate(MP_Mis = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("possession", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
MP_Fel = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("possession", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
MS_Mis = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
MS_Fel = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
CSP_Mis = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("possess", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0)
)
joined %>%
mutate(MP_Mis = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("possession", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
MP_Fel = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("possession", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
MS_Mis = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
MS_Fel = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
CSP_Mis = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("possess", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
CSP_Fel = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("possess", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0)
)
unique(joined$pd_desc)
joined %>%
mutate(MP_Mis = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("possession", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
MP_Fel = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("possession", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
MS_Mis = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
MS_Fel = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
CSP_Mis = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("possess", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
CSP_Fel = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("possess", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
CSS_Mis = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
CSS_Fel = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
CSIS_Mis = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("inent", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
CSIS_Fel = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("inent", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
School = ifelse(grepl("school", pd_desc,ignore.case = T),1,0)
)
unique(pd_desc)
unique(joined$pd_desc)
joined %>%
mutate(MP_Mis = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("possession", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
MP_Fel = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("possession", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
MS_Mis = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
MS_Fel = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
CSP_Mis = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("possess", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
CSP_Fel = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("possess", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
CSS_Mis = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
CSS_Fel = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
CSIS_Mis = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("inent", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
CSIS_Fel = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("inent", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
School = ifelse(grepl("school", pd_desc,ignore.case = T),1,0)
)
joined <- joined %>%
mutate(MP_Mis = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("possession", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
MP_Fel = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("possession", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
MS_Mis = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
MS_Fel = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
CSP_Mis = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("possess", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
CSP_Fel = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("possess", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
CSS_Mis = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
CSS_Fel = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
CSIS_Mis = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("inent", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
CSIS_Fel = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("inent", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
School = ifelse(grepl("school", pd_desc,ignore.case = T),1,0)
)
View(joined)
table(joined$MP_Mis)
table(joined$MP_Fel)
table(joined$MS_Mis)
table(joined$MS_Fel)
table(joined$CSP_Mis)
table(joined$CSP_Fel)
table(joined$CSS_Mis)
table(joined$CSS_Fel)
table(joined$CSIS_Mis)
table(joined$CSIS_Fel)
View(joined)
joined <- joined %>%
mutate(MP_Mis = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("possession", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
MP_Fel = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("possession", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
MS_Mis = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
MS_Fel = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
CSP_Mis = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("possess", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
CSP_Fel = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("possess", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
CSS_Mis = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
CSS_Fel = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
CSIS_Mis = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("intent", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
CSIS_Fel = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("intent", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
School = ifelse(grepl("school", pd_desc,ignore.case = T),1,0)
) %>%
select(-CSS_Mis)
table(joined$CSIS_Mis)
table(joined$CSIS_Fel)
table(joined$School)
joined <- joined %>%
mutate(MP_Mis = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("possession", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
MP_Fel = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("possession", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
MS_Mis = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
MS_Fel = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
CSP_Mis = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("possess", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
CSP_Fel = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("possess", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
CSS_Mis = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
CSS_Fel = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
CSIS_Mis = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("intent", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
CSIS_Fel = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("intent", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
School = ifelse(grepl("school", pd_desc,ignore.case = T),1,0)
) %>%
select(-CSS_Mis, -CSIS_Mis)
write.csv(stat.is,file="si_drugs_mod_arrests.csv")
rm(list=ls())
#### Exploratory Analysis of Drug Arrests ####
library(tidyverse)
library(ggplot2)
si.drugs <- read.csv("data/si_drugs_arrests.csv")
si.drugs <- si.drugs[-1]
##### Arrests by Precinct
si.drugs %>%
group_by(arrest_precinct) %>%
summarise(n=n()) %>%
ggplot(aes(x=arrest_precinct, y = n, fill = factor(arrest_precinct))) +
geom_bar(stat = 'identity') +
geom_text(aes(label = n), position = position_dodge(width = 0.9))+
ggtitle("Number of Drug Arrests by Precinct (20173-YTD)") +
xlab("Precinct") +
ylab("Number Arrests")
# we can see that the majority of drug arrests are happening in 120 precinct, followed by 121, then
# 122 and #123 had the least.
# 120 - Sunnyside, West Brighton, Livingston, Randall Manor, New Brighton, St. George, Ward Hill, Stapleton,
# Clifton, Silver Lake, Gyrmes Hill, Fox Hills, Shore Acres, and Rosebank
# 121 - Willowbrook, Westerleigh, Port Richmond, Mariner's Harbor, Elm Park, Port Ivory, Chelsea, and Bloomfield
# 122 - Eltingville, Great Kills, Bay Terrace, Oakwood Heights, Oakwood Beach, Lighthouse Hill, New Dorp, Grant City,
# Midland Beach, South Beach, Todt Hill, Old Town, Grasmere and Dongan Hills
# 123 - Tottenville, Huguenot, Rossville, Annadale, and Arden Heights
#### Drug Arrests Year
si.drugs %>%
group_by(year) %>%
summarise(n=n()) %>%
filter(year != 2018) %>%  # filtering out  2018 bc not full year only until 6/30/2018
ggplot(aes(x=year,y=n))+
geom_line() +
ggtitle("Drug Arrests by Year") +
ylab("Arrests")
# we can see a peak in 2014, and a decline since then
#### Drug Arrest by Month facet wrap year
si.drugs %>%
group_by(month,year)%>%
summarise(n=n())%>%
mutate(mycol = ifelse(n>250,">250", "<250")) %>%
ggplot(aes(x=factor(month), y = n, fill = mycol)) +
geom_bar(stat = 'identity')+
facet_wrap(vars(year))
names(si.drugs)
#### Exploratory Analysis of Drug Arrests ####
library(tidyverse)
library(ggplot2)
si.drugs <- read.csv("data/si_drugs_arrests.csv")
si.drugs <- si.drugs[-1]
names(si.drugs)
si.drugs %>%
group_by(arrest_precinct,perp_race) %>%
summarise(n=n())
names(si.drugs)
names(si.drugs)
unique(si.drugs$perp_race)
#################################
###### Combine NYPD Arrest Data #########
#################################
## Loading libraries
library(RSocrata)
library(plyr)
library(tidyverse)
library(lubridate)
## Pull in data from Socrata
## Arrest Data YTD
arrestYTD <- read.socrata(url = "https://data.cityofnewyork.us/resource/uip8-fykc.csv")
## Convert Date
arrestYTD$arrest_date <- lubridate::ymd(arrestYTD$arrest_date)
## Add year column
arrestYTD$year <- lubridate::year(arrestYTD$arrest_date)
## Add month column
arrestYTD$month <- lubridate::month(arrestYTD$arrest_date)
## filter for SI
arrestYTD$arrest_boro <- trimws(arrestYTD$arrest_boro)
arrestYTD.SI <- filter(arrestYTD, arrest_boro == "S")
## further filter for drug crimes
arrestYTD.SI.drugs <- filter(arrestYTD.SI, ofns_desc == "DANGEROUS DRUGS" | pd_desc == "MARIJUANA, POSSESSION" |
pd_desc == "UNLAWFUL SALE SYNTHETIC MARIJUANA" |
pd_desc == "IMPAIRED DRIVING, DRUGS")
## most drug releated crimes are under the offense code DANGEROUS DRUGS, but some are hidden in other offense
## codes, I identified these hidden values and put them in the filter.
## Arrest Data Historic
arrestHistoric <-read.socrata(url = "https://data.cityofnewyork.us/resource/8h9b-rp9u.csv")
## Convert Date
arrestHistoric$arrest_date <- lubridate::ymd(arrestHistoric$arrest_date)
## Add year column
arrestHistoric$year <- lubridate::year(arrestHistoric$arrest_date)
## Add month column
arrestHistoric$month <- lubridate::month(arrestHistoric$arrest_date)
## filter for SI
arrestHistoric$arrest_boro <- trimws(arrestHistoric$arrest_boro)
arrestHistoric.SI <- filter(arrestHistoric, arrest_boro == "S")
## further filter for drug crimes
arrestHistoric.SI.drugs <- filter(arrestHistoric.SI, ofns_desc == "DANGEROUS DRUGS" |
pd_desc == "MARIJUANA, POSSESSION" |
pd_desc == "UNLAWFUL SALE SYNTHETIC MARIJUANA" |
pd_desc == "IMPAIRED DRIVING, DRUGS")
## Combine YTD w. Historic Drug Arrests for one dataset
names(arrestHistoric.SI.drugs) == names(arrestYTD.SI.drugs)
si.drugs <- rbind(arrestHistoric.SI.drugs, arrestYTD.SI.drugs)
## clean up pd_desc
si.drugs$pd_desc <- str_remove_all(pattern="\\s{2,}", string = si.drugs$pd_desc)
si.drugs$pd_desc <- str_remove_all(pattern="\\.", string = si.drugs$pd_desc)
names(si.drugs)
unique(si.drugs$perp_sex)
unique(si.drugs$perp_race)
names(si.drugs)
## clean up race
si.drugs[grepl("HISPANIC",si.drugs$perp_race), 15]
## clean up race
si.drugs[grepl("HISPANIC",si.drugs$perp_race), 15] <- "HISPANIC"
si.drugs$perp_race
write.csv("si_drugs_arrests.csv")
write.csv(si.drugs,"si_drugs_arrests.csv")
rm(list=ls())
library(tidyverse)
stat.is<-read.csv("data/si_drugs_arrests.csv")
pl <- read.csv("data/PDCODE_PenalLaw.csv")
# join with penal codes
# clean codes, remove punc etc.
pl$LAW_NYS <- gsub("\\.", "", pl$LAW_NYS)
pl$LAW_NYS <- gsub("\\s{2,}", "",pl$LAW_NYS)
names(pl)[2] <- "law_code"
#join with penal codes
joined <- left_join(stat.is, pl, by = c("law_code"))
#find failed ones, reason: some have extra 0s at the end
failed <- joined[is.na(joined$PDCODE_VALUE) & is.na(joined$LIT_LONG) & is.na(joined$CATEGORY) & is.na(joined$LIT_SHORT),]
failed <- unique(failed$law_code)
#for those that failed originally, remove the padded 0s, rematch with the penal law codes
joined <- joined %>%
mutate(law_code = ifelse(law_code %in% failed, gsub("00$", "", law_code), law_code)) %>%
left_join(pl, by = c("law_code")) %>%
select(-CATEGORY.x, -LIT_LONG.x, -LIT_SHORT.x, -X, -PDCODE_VALUE.x)
joined$LIT_SHORT.y <- as.character(joined$LIT_SHORT.y)
sum(is.na(joined$LIT_SHORT.y)) #can confirm that there is only 10 not matched
# Frankie's old code
# stat.is$arrest_date<-as.Date(stat.is$arrest_date)
# range(stat.is$arrest_date)
# stat.is$ofns_desc<-as.character(stat.is$ofns_desc)
# str(stat.is)
# stat.is$Marijuana<-ifelse(grepl("MARIJUANA",stat.is$pd_desc,ignore.case = T),1,0)
# stat.is$Sale<-ifelse(grepl("SALE",stat.is$pd_desc,ignore.case = T),1,0)
# stat.is$Intent<-ifelse(grepl("SELL",stat.is$pd_desc,ignore.case = T),1,0)
# stat.is$School<-ifelse(grepl("SCHOOL",stat.is$pd_desc,ignore.case = T),1,0)
joined$law_cat_cd <- as.character(joined$law_cat_cd)
joined <- joined %>%
mutate(MP_Mis = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("possession", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
MP_Fel = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("possession", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
MS_Mis = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
MS_Fel = ifelse(grepl("marijuana", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
CSP_Mis = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("possess", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
CSP_Fel = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("possess", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
CSS_Mis = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
CSS_Fel = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("sale", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
CSIS_Mis = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("intent", pd_desc, ignore.case = T) &
law_cat_cd == "M" , 1,0),
CSIS_Fel = ifelse(grepl("controlled", pd_desc,ignore.case = T) &
grepl("intent", pd_desc, ignore.case = T) &
law_cat_cd == "F" , 1,0),
School = ifelse(grepl("school", pd_desc,ignore.case = T),1,0)
) %>%
select(-CSS_Mis, -CSIS_Mis)
write.csv(stat.is,file="si_drugs_mod_arrests.csv")
rm(list=ls())
#### Exploratory Analysis of Drug Arrests ####
library(tidyverse)
library(ggplot2)
si.drugs <- read.csv("data/si_drugs_arrests.csv")
si.drugs <- si.drugs[-1]
##### Arrests by Precinct
si.drugs %>%
group_by(arrest_precinct) %>%
summarise(n=n()) %>%
ggplot(aes(x=arrest_precinct, y = n, fill = factor(arrest_precinct))) +
geom_bar(stat = 'identity') +
geom_text(aes(label = n), position = position_dodge(width = 0.9))+
ggtitle("Number of Drug Arrests by Precinct (20173-YTD)") +
xlab("Precinct") +
ylab("Number Arrests")
# we can see that the majority of drug arrests are happening in 120 precinct, followed by 121, then
# 122 and #123 had the least.
# 120 - Sunnyside, West Brighton, Livingston, Randall Manor, New Brighton, St. George, Ward Hill, Stapleton,
# Clifton, Silver Lake, Gyrmes Hill, Fox Hills, Shore Acres, and Rosebank
# 121 - Willowbrook, Westerleigh, Port Richmond, Mariner's Harbor, Elm Park, Port Ivory, Chelsea, and Bloomfield
# 122 - Eltingville, Great Kills, Bay Terrace, Oakwood Heights, Oakwood Beach, Lighthouse Hill, New Dorp, Grant City,
# Midland Beach, South Beach, Todt Hill, Old Town, Grasmere and Dongan Hills
# 123 - Tottenville, Huguenot, Rossville, Annadale, and Arden Heights
#### Drug Arrests Year
si.drugs %>%
group_by(year) %>%
summarise(n=n()) %>%
filter(year != 2018) %>%  # filtering out  2018 bc not full year only until 6/30/2018
ggplot(aes(x=year,y=n))+
geom_line() +
ggtitle("Drug Arrests by Year") +
ylab("Arrests")
# we can see a peak in 2014, and a decline since then
#### Drug Arrest by Month facet wrap year
si.drugs %>%
group_by(month,year)%>%
summarise(n=n())%>%
mutate(mycol = ifelse(n>250,">250", "<250")) %>%
ggplot(aes(x=factor(month), y = n, fill = mycol)) +
geom_bar(stat = 'identity')+
facet_wrap(vars(year))
## nothing really telling here! I thought maybe we would see more traffic in summer months but this doesnt
## appear to be the case.
# Arrests by Precinct by Race
si.drugs %>%
group_by(arrest_precinct,perp_race) %>%
summarise(n=n())
#### Exploratory Analysis of Drug Arrests ####
library(tidyverse)
library(ggplot2)
si.drugs <- read.csv("data/si_drugs_arrests.csv")
si.drugs <- si.drugs[-1]
si.drugs %>%
group_by(arrest_precinct) %>%
summarise(n=n()) %>%
ggplot(aes(x=arrest_precinct, y = n, fill = factor(arrest_precinct))) +
geom_bar(stat = 'identity') +
geom_text(aes(label = n), position = position_dodge(width = 0.9))+
ggtitle("Number of Drug Arrests by Precinct (20173-YTD)") +
xlab("Precinct") +
ylab("Number Arrests")
View(si.drugs)
si.drugs %>%
group_by(arrest_precinct) %>%
summarise(n=n())
rlang::last_error()
library(tidyverse)
library(ggplot2)
si.drugs %>%
group_by(arrest_precinct) %>%
summarise(n=n()) %>%
ggplot(aes(x=arrest_precinct, y = n, fill = factor(arrest_precinct))) +
geom_bar(stat = 'identity') +
geom_text(aes(label = n), position = position_dodge(width = 0.9))+
ggtitle("Number of Drug Arrests by Precinct (20173-YTD)") +
xlab("Precinct") +
ylab("Number Arrests")
